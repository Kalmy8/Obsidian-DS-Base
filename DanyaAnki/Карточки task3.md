
![[Pasted image 20240928123302.png]]
Что это за график? Почему функция на нем убывает?
?
Это график суммы квадратов ошибок полиномиальной модели. С увеличением степени полинома ошибка всегда будет убывать, потому что регрессия более высокой степени всегда более "гибкая", и может лучше описать тренировочные данные. Вместе с тем, такая регрессия хуже справится с новыми, тестовыми данными, потому что она сильно переобучается под тренировочные данные, неадекватно изгибаясь.

![[Pasted image 20240928123529.png]]
Что делает нижняя строчка?
?
Нижняя строчка добавляет к матрице столбец единиц, что нужно для использования моделей из statsmodels. Затем этот столбец будет расцениваться как отдельный признак, и коэффициент, который модель выучит для него, представляет собой свободный член линейной регрессии.
![[Pasted image 20240928123614.png]]

![[Pasted image 20240928123730.png]]
Что за параметры передаются в функцию?
?
В функцию передаются параметры "число предсказателей" (чем больше, тем лучше, но больше вычислительных расходов) и "максимальное количество используемых предикторов". Второй параметр ограничивает каждого из предсказателей, обучая их не на всем множестве данных, а только на каком-то подмножестве столбцов. Таким образом получаются "узкопрофильные" специалисты, и в среднем они лучше справляются с задачей предсказания. Значение sqrt означает, что при количестве признаков = 4, каждый предсказатель выучит 2, при количестве 9 выучит 3 и т.д.

![[Pasted image 20240928124035.png]]
Почему матрицы distances и indexes обрезаются слева на 1 столбец
? 
Потому что по дефолту NearestNeighbours вычисляет расстояние от точки до самой себя, а не до соседа. Поэтому и число соседей 6.
Те точки, которые находятся слишком далеко от своих соседей, удаляются из датасета