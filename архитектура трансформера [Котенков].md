#nlp

[Transformere, explained in detail | Igor Kotenkov | NLP Lecture (in Russian) - YouTube](https://www.youtube.com/watch?v=iOrNbK2T92M)

### –ü–æ—á–µ–º—É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã —Ç–∞–∫ —Ö–æ—Ä–æ—à–∏?

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≤ –ª–µ–∫—Ü–∏–∏ —ç—Ç–æ—Ç —Å–ª–∞–π–¥ —à–µ–ª –ø–æ—Å–ª–µ–¥–Ω–∏–º, –Ω–æ —è —Ä–µ—à–∏–ª —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –µ–≥–æ –ø–µ—Ä–≤—ã–º

![[Pasted image 20251025180734.png]]
1. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã –ø–æ –≤–æ–ª—à–µ–±–Ω—ã–º –ø—Ä–∏—á–∏–Ω–∞–º —Ö–æ—Ä–æ—à–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–µ–±—è –≤ –∑–∞–¥–∞—á–∞—Ö CV –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–∞—Ö, –∫–æ–Ω–∫—É—Ä–∏—Ä—É—è —Å RNN, CNN (—Ö–æ—Ç—è —Ç–µ –±—ã–ª–∏ –∏–∑–æ–±—Ä–µ—Ç–µ–Ω—ã –≥–æ—Ä–∞–∑–¥–æ —Ä–∞–Ω—å—à–µ –°–ü–ï–¶–ò–ê–õ–¨–ù–û –ø–æ–¥ —Ç–µ –∂–µ –∑–∞–¥–∞—á–∏)
	- –Ø–≤–ª—è—é—Ç—Å—è —Ö–æ—Ä–æ—à–∏–º Baseline –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ª—é–±–æ–π –∑–∞–¥–∞—á–∏
	- –õ–µ–≥–∫–æ fine-—Ç—é–Ω–∏—Ç—å –ø–æ–¥ –ª—é–±—É—é —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫—É—é –∑–∞–¥–∞—á—É
	- –û—á–µ–Ω—å –ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å: —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –±–ª–æ–∫–æ–≤, –Ω–∞—Ä–∞—â–∏–≤–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å/–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ç–æ—Ä—ã—Ö –º—ã –ø–æ–ª—É—á–∞–µ–º –ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ
2. –ß–µ–º –¥–æ–ª—å—à–µ —ç—Ç–∞–ø –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (–Ω–∞ –≤—Å—ë–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ) - —Ç–µ–º –±–æ–ª—å—à–µ –∑–∞–ª–æ–∂–µ–Ω–æ –≤ –º–æ–¥–µ–ª—å –∑–Ω–∞–Ω–∏–π. –ó–∞—Ç–µ–º –ø—Ä–∏ transfer learning –º—ã –º–æ–∂–µ–º –¥–æ—Ç–∞—â–∏—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –º–∞–ª–µ–Ω—å–∫—É—é —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫—É—é –∑–∞–¥–∞—á—É, –Ω–æ –æ–Ω–∞ –ø—Ä–∏ —ç—Ç–æ–º –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –≤—ã—É—á–µ–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ –∑–Ω–∞–Ω–∏—è
3. –ù–∏–∑–∫–∞—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è/–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞—è. –°–æ—Å—Ç–æ–∏—Ç –∏–∑ –ª–∏–Ω–µ–π–Ω—ã—Ö —Å–ª–æ–µ–≤ (–ø—Ä—è–º –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω), –ø–æ —Ñ–∞–∫—Ç—É —è–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∑–∞–¥–∞—á—É –º–∞—Ç—Ä–∏—á–Ω–æ–≥–æ –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—É—é —É–∂–µ –æ—á–µ–Ω—å –¥–∞–≤–Ω–æ –∏ —Ö–æ—Ä–æ—à–æ –Ω–∞—É—á–∏–ª–∏—Å—å —Ä–µ—à–∞—Ç—å. **+ Self-Attention –æ—Ç–ª–∏—á–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—Å—è** (–∫–∞–º–µ–Ω—å –≤ –æ–≥–æ—Ä–æ–¥ RNN)

### Word2Vec
- –í–∏–¥–µ–æ –ø–æ –±–æ–ª—å—à–µ–π —á–∞—Å—Ç–∏ —Ä–∞–∑–±–∏—Ä–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç—å—é "Attention is all you need"
- –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤—Å—ë —Å –∏—Å—Ç–æ—Ä–∏–∏ NLP: 2013 –≥–æ–¥, –ø–æ—è–≤–ª–µ–Ω–∏–µ Word2Vec
	- –ü–æ—Ä—è–¥–æ–∫ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏:
		- **–ì–æ—Ç–æ–≤–∏–º —Å–ª–æ–≤–∞—Ä—å:** –ë–µ—Ä–µ–º –í–°–ï —Å–ª–æ–≤–∞, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –ø–ª–∞–Ω–∏—Ä—É–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å, —Å–æ—Å—Ç–∞–≤–ª—è–µ–º –µ–¥–∏–Ω—ã–π –æ–≥—Ä–æ–º–Ω–µ–π—à–∏–π –º–∞—Å—Å–∏–≤
			- –°–ª–æ–≤–∞ –Ω–µ –∏–∑ —Å–ª–æ–≤–∞—Ä—è –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –±—É–¥—É—Ç –ø—Ä–æ—Å—Ç–æ –≤—ã–±—Ä–æ—à–µ–Ω—ã
				- –£–∂–µ –≤–∏–¥–Ω–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥ –Ω–µ –≥–∏–±–∫–∏–π
				- –ò–∑-–∑–∞ —Ç–æ–≥–æ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ç—è–∂–µ–ª–æ–≥–æ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞:
					- –õ–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è, —Å—Ç–µ–º–º–∏–Ω–≥
					- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—á–∞—Ç–æ–∫
					- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü. —Å–∏–º–≤–æ–ª–æ–≤, —á–∏—Å–µ–ª
		- **–î–∞–ª–µ–µ?** –ü–æ—Å–ª–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Å–ª–æ–≤–∞—Ä—è –º—ã –æ–±—É—á–∞–µ–º –Ω–µ–≥–ª—É–±–æ–∫—É—é –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å –æ–¥–Ω–æ–π –∏–∑ –¥–≤—É—Ö –∑–∞–¥–∞—á, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏. –ù–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç –Ω–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–µ—Ç–∏, –∞ **–≤–µ—Å–∞ –µ–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è** ‚Äî —ç—Ç–æ –∏ –±—É–¥–µ—Ç –º–∞—Ç—Ä–∏—Ü–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.
			- **CBOW (Continuous Bag-of-Words):** –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ –ø–æ –µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (–æ–∫—Ä—É–∂–∞—é—â–∏–º —Å–ª–æ–≤–∞–º). –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ —Ñ—Ä–∞–∑–µ "The quick ___ fox jumps" –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å "brown". –ú–µ—Ç–æ–¥ –±—ã—Å—Ç—Ä—ã–π, —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å–ª–æ–≤.
			- **Skip-gram:** –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º—É —Å–ª–æ–≤—É. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ —Å–ª–æ–≤—É "brown" –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å "The", "quick", "fox", "jumps". –ú–µ—Ç–æ–¥ –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ä–µ–¥–∫–∏—Ö —Å–ª–æ–≤ –∏ –≤ —Ü–µ–ª–æ–º —Å—á–∏—Ç–∞–µ—Ç—Å—è –±–æ–ª–µ–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º.
	- –ï—Å–ª–∏ –≤—Å–µ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ - –º—ã –ø–æ–ª—É—á–∏–º **—Å–ø–∏—Å–æ–∫ (–º–∞—Ç—Ä–∏—Ü—É) —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤**. –£ –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ –∏–∑ —Å–ª–æ–≤–∞—Ä—è –µ—Å—Ç—å –µ–≥–æ –∏–Ω–¥–µ–∫—Å (–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ —Å–ø–∏—Å–∫–µ) –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –≤–µ–∫—Ç–æ—Ä –¥–ª–∏–Ω—ã \<N>. –≠—Ç–æ –∏ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è "–æ–±—É—á–∏—Ç—å" Word2Vec
		- –î–ª–∏–Ω–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–∞ –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ–≤
	-  –£—Å—Ä–µ–¥–Ω–∏–≤ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–∞, –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ **—ç–º–±–µ–¥–¥–∏–Ω–≥–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è...**. –ü—Ä–∞–≤–¥–∞ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ - –∫—Ä–∞–π–Ω–µ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥, –ø–æ —Ö–æ–¥—É —Ç–µ—Ä—è–µ—Ç—Å—è –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

### –ü—Ä–æ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—é:
- –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –º—ã —Ä–µ—à–∏–ª–∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å Word2Vec, –Ω–æ —Å–æ—Å—Ç–∞–≤–ª—è–µ–º —Å–ª–æ–≤–∞—Ä—å –Ω–µ –∏–∑ –≤—Å–µ—Ö —Å–ª–æ–≤, –∞ —Ç–æ–ª—å–∫–æ –∏—Ö –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –±—É–∫–≤
	- –≠—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Ç–æ–º—É, —á—Ç–æ —Å–ª–æ–≤–∞—Ä—å –±—É–¥–µ—Ç —Å–æ—Å—Ç–æ—è—Ç—å –≤—Å–µ–≥–æ –∏–∑ 20-100 –ø–æ–∑–∏—Ü–∏–π
	- –ù–æ –≤ —Ç–æ –∂–µ –≤—Ä–µ–º—è –ª—é–±–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç—ã—Å—è—á–∏ –ø–æ–¥–æ–±–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤, —á—Ç–æ –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ –∑–∞–º–µ–¥–ª—è–µ—Ç –≤—Ä–µ–º—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
		- –Ø –¥—É–º–∞—é –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤ —ç—Ç–æ–º?
	- –ï—Å–ª–∏ –∂–µ –º—ã –±—É–¥–µ–º —Å—Ç—Ä–æ–∏—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–æ–≤ - —É –Ω–∞—Å –±—É–¥–µ—Ç –æ–≥—Ä–æ–º–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å (–º–∏–ª–ª–∏–æ–Ω—ã —Å–ª–æ–≤), –Ω–æ –∑–∞—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ–∫—Ç–æ—Ä–æ–≤ –∫—Ä–∞—Ç–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å—Å—è
	- –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ —Ö–æ—á–µ—Ç—Å—è –∫–∞–∫-—Ç–æ –Ω–∞–π—Ç–∏ –∑–æ–ª–æ—Ç—É—é —Å–µ—Ä–µ–¥–∏–Ω—É –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –¥–≤—É–º—è –∫—Ä–∞–π–Ω–æ—Å—Ç—è–º–∏
	- –¢–∞–∫–æ–π "—Å–µ—Ä–µ–¥–∏–Ω–æ–π" —è–≤–ª—è–µ—Ç—Å—è —Å–ª–æ–≤–∞—Ä—å, **–ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∏–∑ —Ç–æ–∫–µ–Ω–æ–≤**:
		- **–¢–æ–∫–µ–Ω -** –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ (–±–æ–ª—å—à–µ, —á–µ–º –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª, –Ω–æ –º–µ–Ω—å—à–µ, —á–µ–º —Ü–µ–ª–æ–µ —Å–ª–æ–≤–æ)
		- –¢–æ–∫–µ–Ω—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ç–∏–ø–∞ **BPE (Byte-Pair Encoding) –∏–ª–∏ WordPiece + SentencePiece**
			- **BPE** —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –±–∞–π—Ç–∞—Ö, —É–Ω–∏–≤–µ—Ä—Å–∞–ª–µ–Ω –¥–ª—è –ª—é–±–æ–≥–æ —è–∑—ã–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ GPT –º–æ–¥–µ–ª—è—Ö
			- –û—Å—Ç–∞–ª—å–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ BERT-like –º–æ–¥–µ–ª—è—Ö –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –¥–ª—è —è–∑—ã–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –ø–æ –ø—Ä–æ–±–µ–ª—É (–Ω–µ-–∞–∑–∏–∞—Ç—Å–∫–∏—Ö) 
		- –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞:![[Pasted image 20251013222652.png]]
			- –ù–∞ –æ—Å–Ω–æ–≤–µ –≤—Å–µ—Ö —Å–ª–æ–≤ –¥–∞—Ç–∞—Å–µ—Ç–∞ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å **vocabulary - –Ω–∞–±–æ—Ä –≤—Å–µ—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤**
			- **–ü–æ—Å—á–∏—Ç–∞–µ–º —á–∞—Å—Ç–æ—Ç—ã –≤—Å–µ—Ö –ø–∞—Ä –∏–∑ vocabulary,** –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∞–ª—å–Ω–æ –≤—Å—Ç—Ä–µ—á–∞–ª–∏—Å—å –≤ –Ω–∞—à–∏—Ö —Å–ª–æ–≤–∞—Ö (–Ω–µ –≤—Å–µ —Å–∏–º–≤–æ–ª—ã —Å–æ –≤—Å–µ–º–∏, –∞ —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º –ø–æ—Ä—è–¥–∫–µ, –∫–∞–∫ –≤ –Ω–∞—à–∏—Ö —Å–ª–æ–≤–∞—Ö!)
			- –î–æ–±–∞–≤–ª—è–µ–º —Å–∞–º—É—é –ø–æ–ø—É–ª—è—Ä–Ω—É—é –ø–∞—Ä—É –≤ **vocabulary**
			- –ø–æ–≤—Ç–æ—Ä—è–µ–º –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ, –ø–æ–∫–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω–µ–º **vocabulary_size** - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–≥–æ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (–ø—Ä–∏ —ç—Ç–æ–º –ø–æ–ª—É—á–∞—Ç—Å—è –∏ —Ç—Ä–æ–π–∫–∏ –∏ —á–µ—Ç–≤–µ—Ä–∫–∏)
				- –ü–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ —Ö–æ—Ç–∏–º –¥–µ–ª–∞—Ç—å —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º, —á—Ç–æ–±—ã –Ω–µ –≤–∫–ª—é—á–∞—Ç—å –≤—Å—è–∫–∏–π –º—É—Å–æ—Ä –∏ —Å–ª–æ–≤–∞ —Å –æ–ø–µ—á–∞—Ç–∫–∞–º–∏. –í–µ–∫—Ç–æ—Ä–∞ –Ω–∞ —Ç–∞–∫–∏–µ —Ç–æ–∫–µ–Ω—ã –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –Ω–µ –æ–±—É—á–∞—Ç—Å—è
				- 25-60–∫ - –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä **–¥–ª—è –æ–¥–Ω–æ–≥–æ —è–∑—ã–∫–∞.** –ü–æ—Ä—è–¥–∫–∞ 200–∫ - –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–æ–≤ (–ø–æ—á–∏—Ç–∞—Ç—å –ø—Ä–æ —Ç–æ–∫–µ–Ω–∑–∞–π–µ—Ä—ã —Å –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–µ–π). –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞–¥–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ **vocabulary** –ø–æ–ª—É—á–∏–ª—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ. –ü–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º—ã –Ω–µ —Ö–æ—Ç–∏–º –≤–∏–¥–µ—Ç—å –≤ –Ω–µ–º —Ä–µ–¥–∫–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è/–∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã/—Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è (–ø–æ—Ç–æ–º—É —á—Ç–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –Ω–∞ –Ω–∏—Ö –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–µ –æ–±—É—á–∞—Ç—Å—è)

[!quote] –ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫ –º–æ–¥–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–∫–µ–Ω—ã?
> –†–∞–Ω–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Ç–∏–ø–∞ GPT-3 –Ω–µ –º–æ–≥–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—É–∫–≤ –≤ —Å–ª–æ–≤–µ "–Ω–µ–ø—Ä–µ–¥–Ω–∞–º–µ—Ä–µ–Ω–Ω—ã–π". –ü–æ—á–µ–º—É?
> - **–ú—ã –≤–∏–¥–∏–º:** 16 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –±—É–∫–≤.
> - **–ú–æ–¥–µ–ª—å –≤–∏–¥–∏—Ç:** –ü—Ä–∏–º–µ—Ä–Ω–æ 3 —Ç–æ–∫–µ–Ω–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, `["–Ω–µ–ø—Ä–µ–¥", "–Ω–∞–º–µ", "—Ä–µ–Ω–Ω—ã–π"]`.
> 
> –ú–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ —Å –±—É–∫–≤–∞–º–∏, –∞ —Å ID —ç—Ç–∏—Ö "—Å–º—ã—Å–ª–æ–≤—ã—Ö –∫—É—Å–∫–æ–≤". –û–Ω–∞ **–Ω–µ –∏–º–µ–µ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏–º–≤–æ–ª–∞–º** –≤–Ω—É—Ç—Ä–∏ —Ç–æ–∫–µ–Ω–∞. –ó–∞–¥–∞—á–∞ "–ø–æ—Å—á–∏—Ç–∞—Ç—å –±—É–∫–≤—ã" –¥–ª—è –Ω–µ–µ –∑–≤—É—á–∏—Ç –∫–∞–∫ "–ø–æ—Å—á–∏—Ç–∞–π —Å–∏–º–≤–æ–ª—ã –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ID `[3451, 8720, 15344]`", —á—Ç–æ –¥–ª—è –Ω–µ–µ —è–≤–ª—è–µ—Ç—Å—è –Ω–µ—Ä–µ—à–∞–µ–º–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–π –∑–∞–¥–∞—á–µ–π, —Ç–∞–∫ –∫–∞–∫ –µ–µ –æ–±—É—á–∞–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–∫–µ–Ω, –∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–∏–º–≤–æ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.
> 
> –ë–æ–ª–µ–µ –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ (GPT-4) —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å —ç—Ç–∏–º –ª—É—á—à–µ, –Ω–æ –Ω–µ –ø–æ—Ç–æ–º—É —á—Ç–æ –≤–∏–¥—è—Ç –±—É–∫–≤—ã. –≠—Ç–æ –≤–æ–∑–Ω–∏–∫—à–µ–µ –∏–∑-–∑–∞ –æ–≥—Ä–æ–º–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∞ –∏ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ –∫–æ–¥–µ/—Ç–µ–∫—Å—Ç–∞—Ö, –≥–¥–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª—Å—è –ø–æ–¥—Å—á–µ—Ç. –ì—Ä—É–±–æ –≥–æ–≤–æ—Ä—è, –º–æ–¥–µ–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã [3451, 8720, 15344] —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π "–¥–ª–∏–Ω–æ–π" (6, 4, 6)

### –ü—Ä–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä:
- –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ –≤–æ–∑–Ω–∏–∫ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–µ—à–µ–Ω–∏—è **–∑–∞–¥–∞—á–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞** –ø—Ä–∏ –ø–æ–º–æ—â–∏ –¥–≤—É—Ö –º–æ–¥–µ–ª–µ–π: **—ç–Ω–∫–æ–¥–µ—Ä–∞ –∏ –¥–µ–∫–æ–¥–µ—Ä–∞**
	- –≠–Ω–∫–æ–¥–µ—Ä –ø–µ—Ä–µ–≤–æ–¥–∏–ª —Ç–µ–∫—Å—Ç  (–ø—Ä. –Ω–∞ —Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–æ–º) –≤ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ (–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Å–º—ã—Å–ª–æ–≤)
	- –î–µ–∫–æ–¥–µ—Ä –ø–µ—Ä–µ–≤–æ–¥–∏–ª –∏–∑ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ —Å–º—ã—Å–ª–æ–≤ –Ω–∞ –Ω—É–∂–Ω—ã–π —è–∑—ã–∫
	- –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –Ω–µ—Ç –Ω—É–∂–¥—ã –æ–±—É—á–∞—Ç—å –º–æ–¥–µ–ª—å –ø–æ–¥ –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–∞—Ä—ã —è–∑—ã–∫–æ–≤
- ![[Pasted image 20251014225119.png]]

#### –û—Ç–∫—É–¥–∞ –±–µ—Ä—É—Ç—Å—è –Ω–∞—á–∞–ª—å–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏? –°–ª–æ–π Embedding Layer
- **–ö–ª—é—á–µ–≤–æ–π –≤–æ–ø—Ä–æ—Å:** –ü—Ä–µ–∂–¥–µ —á–µ–º —ç–Ω–∫–æ–¥–µ—Ä –∏–ª–∏ –¥–µ–∫–æ–¥–µ—Ä –Ω–∞—á–Ω—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã, –æ—Ç–∫—É–¥–∞ –±–µ—Ä—É—Ç—Å—è –∏—Ö —Å–∞–º—ã–µ –ø–µ—Ä–≤—ã–µ, "—Å—ã—Ä—ã–µ" –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è?
- **–û—Ç–≤–µ—Ç:** –ò–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±—É—á–∞–µ–º–æ–≥–æ —Å–ª–æ—è **Embedding Layer**, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º—ã–º –ø–µ—Ä–≤—ã–º —Å–ª–æ–µ–º –ª—é–±–æ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏.
- **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
	- –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–µ–±–µ –æ–≥—Ä–æ–º–Ω—É—é **–æ–±—É—á–∞–µ–º—É—é** —Ç–∞–±–ª–∏—Ü—É (–º–∞—Ç—Ä–∏—Ü—É).
	- **–°—Ç—Ä–æ–∫–∏** —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –≤—Å–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–º —Ç–æ–∫–µ–Ω–∞–º –≤ —Å–ª–æ–≤–∞—Ä–µ –º–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 50 000 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤).
	- **–°—Ç–æ–ª–±—Ü—ã** ‚Äî —ç—Ç–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 768 —á–∏—Å–µ–ª).
	- –ö–æ–≥–¥–∞ –Ω–∞ –≤—Ö–æ–¥ –º–æ–¥–µ–ª–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å ID —Ç–æ–∫–µ–Ω–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `[5021, 421]` –¥–ª—è —Ñ—Ä–∞–∑—ã "cat sat"), –º–æ–¥–µ–ª—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ ID –ø—Ä–æ—Å—Ç–æ **–Ω–∞—Ö–æ–¥–∏—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä–æ–∫—É** –≤ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ.
	- –≠—Ç–æ—Ç –≤–µ–∫—Ç–æ—Ä –∏ —è–≤–ª—è–µ—Ç—Å—è **–Ω–∞—á–∞–ª—å–Ω—ã–º, –Ω–µ–∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–º** –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞.
- **–í–∞–∂–Ω–æ:** –≠—Ç–∞ –ª–æ–≥–∏–∫–∞ **–æ–¥–∏–Ω–∞–∫–æ–≤–∞** –∏ –¥–ª—è Encoder-only –º–æ–¥–µ–ª–µ–π (BERT), –∏ –¥–ª—è Decoder-only –º–æ–¥–µ–ª–µ–π (GPT). –≠–Ω–∫–æ–¥–µ—Ä –Ω–µ *—Å–æ–∑–¥–∞–µ—Ç* –Ω–∞—á–∞–ª—å–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏, –æ–Ω, —Ç–∞–∫ –∂–µ –∫–∞–∫ –∏ GPT, *–ø–æ–ª—É—á–∞–µ—Ç* –∏—Ö –æ—Ç Embedding Layer, –∞ –∑–∞—Ç–µ–º –æ–±–æ–≥–∞—â–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º.

#### –î–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ —ç–Ω–∫–æ–¥–µ—Ä: 
![[Pasted image 20251021213235.png]]
- –ö–∞–∂–¥—ã–π –±–ª–æ–∫ –∏–º–µ–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: N —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Ä–∞–∑–º–µ—Ä–∞ D –Ω–∞ –≤—Ö–æ–¥ –∏ –Ω–∞ –≤—ã—Ö–æ–¥ (—ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Ö —Å—Ç–∞–∫–∞—Ç—å)
	- **Self-Attention:** –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é. –ü–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –≥–ª—è–¥—è –Ω–∞ —Ç–æ–∫–µ–Ω —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç (—Ç–æ–∫–µ–Ω—ã –≤–æ–∫—Ä—É–≥) 
	- **Feed Forward Neural Network:** –Ω–∞–±–æ—Ä –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç "–æ–±—É—á–∞—Ç—å" –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏ (—Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ 75% –≤—Å–µ—Ö –≤–µ—Å–æ–≤ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞ aka "—Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∑–Ω–∞–Ω–∏–π –º–æ–¥–µ–ª–∏")
	 
##### –î–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ Feed Forward
![[Pasted image 20251021213906.png]]
- –°–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –ª–∏–Ω–µ–π–Ω—ã—Ö —Å–ª–æ–µ–≤ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π —Ç–∏–ø–∞ ReLU
- –ü–µ—Ä–≤—ã–π —Å–ª–æ–π —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –º–∞—Ç—Ä–∏—Ü—É —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ K —Ä–∞–∑, –≤—Ç–æ—Ä–æ–π —É–º–µ–Ω—å—à–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ
	- K –ø–æ–¥–±–∏—Ä–∞–ª–∏ —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏. –ï—Å–ª–∏ K = 2, —Ç–æ –≤–µ—Å–æ–≤ –≤ –º–æ–¥–µ–ª–∏ –±—É–¥–µ—Ç –º–∞–ª–æ, –æ–±—É—á–∞–µ—Ç—Å—è –º–µ–Ω—å—à–µ. –ï—Å–ª–∏ K = 8, —Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤ –∏–∑–±—ã—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∞—è. 4 - —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- –†–∞—Å—Å—É–∂–¥–∞–µ–º —Å –ø–æ–∑–∏—Ü–∏–∏ –º–∞—Ç—Ä–∏—á–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è (—Ç—É—Ç –ª—É—á—à–µ –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å): 
	- –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, –Ω–∞ –≤—Ö–æ–¥ –ø–æ—Å—Ç—É–ø–∏–ª–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–∑ 10 —Ç–æ–∫–µ–Ω–æ–≤ —Ç–∏–ø–∞ [1,200,1670...]
	- –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –¥–æ—Å—Ç–∞–ª–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥ (–≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ M)
	- —É—Å—Ä–µ–¥–Ω–∏–ª–∏ –∏—Ö - –ø–æ–ª—É—á–∏–ª–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ M
	- –ø–æ–¥–∞–µ–º –≤–µ–∫—Ç–æ—Ä D_M –Ω–∞ –≤—Ö–æ–¥ –±–ª–æ–∫–∞ —ç–Ω–∫–æ–¥–µ—Ä–æ–≤
	- –≤–µ–∫—Ç–æ—Ä D_M —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—É—é **–º–∞—Ç—Ä–∏—Ü—É D_M x D_ff**, –ø–æ–ª—É—á–∞–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä D_ff, –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å —Ç–∏–ø–∞ reLU (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞ –≤ 0, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Å—Ç–∞–≤–ª—è–µ–º)
	- –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –≤ –Ω–µ–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –≤–µ–∫—Ç–æ—Ä–µ D_ff –∫—Ä–æ–º–µ –æ–¥–Ω–æ–≥–æ - –Ω—É–ª–∏. –ê —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - –µ–¥–∏–Ω–∏—á–∫–∞
	- –≠—Ç–æ—Ç –≤–µ–∫—Ç–æ—Ä –¥–∞–ª–µ–µ –±—É–¥–µ—Ç —É–º–Ω–æ–∂–∞—Ç—å—Å—è –Ω–∞ **–º–∞—Ç—Ä–∏—Ü—É D_ff x D_M**
	- ![[Pasted image 20251021220238.png]]
	- **–ò–Ω—Ç—É–∏—Ü–∏—è: –≤—Ç–æ—Ä–∞—è –º–∞—Ç—Ä–∏—Ü–∞ (D_ff x D_M) —Ö—Ä–∞–Ω–∏—Ç –∑–Ω–∞–Ω–∏—è –º–æ–¥–µ–ª–∏, –≤–µ–∫—Ç–æ—Ä D_ff –ø–æ–∫–∞–∑—ã–≤–µ—Ç, —Å –∫–∞–∫–∏–º–∏ –≤–µ—Å–∞–º–∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ —ç—Ç–æ–π –º–∞—Ç—Ä–∏—Ü—ã, –∞ –ø–µ—Ä–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ (D_M x D_ff) –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤–µ–∫—Ç–æ—Ä D_ff –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ –∑–∞–ø—Ä–æ—Å–∞**
	- **–ò–Ω—Ç—É–∏—Ü–∏—è 2: —ç–Ω–∫–æ–¥–µ—Ä—ã –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è –∏–∑–≤–ª–µ–∫–∞—é—Ç —Å–ª–æ–∂–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –∏ —Å–º—ã—Å–ª—ã, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ —ç–Ω–∫–æ–¥–µ—Ä—ã –Ω–∏–∂–Ω–µ–≥–æ - —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç —Å–æ—á–µ—Ç–∞–Ω–∏—è –±—É–∫–≤, —Ñ–æ—Ä–º–∏—Ä—É—é—Ç –∏–∑ –Ω–∏—Ö —Å–ª–æ–≤–∞**
		- –°—Ç–∞–∫–∞—Ç—å —ç–Ω–∫–æ–¥–µ—Ä—ã –º–æ–∂–Ω–æ —Ö–æ—Ç—å –¥–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏, –Ω–æ —ç—Ç–æ —Å–¥–µ–ª–∞–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–æ–ª—å—à–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ! –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —á–∞—Å—Ç–æ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —á–∏—Å–ª–æ –≤–µ—Å–æ–≤ –∑–∞ —Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –º–∞—Ç—Ä–∏—Ü –ª–∏–Ω–µ–π–Ω—ã—Ö —Å–ª–æ–µ–≤, –∞ –Ω–µ –∑–∞ —Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–Ω–∫–æ–¥–µ—Ä–æ–≤
	- **–ü—Ä–∏–º–µ—Ä: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–ª –∑–∞–ø—Ä–æ—Å "—á—Ç–æ —Ç–∞–∫–æ–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç". –ü–æ–ø–∞–≤ –≤ —ç–Ω–∫–æ–¥–µ—Ä –Ω–∏–∂–Ω–µ–≥–æ —Å–ª–æ—è, **
##### –î–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ Self-Attention:
![[Pasted image 20251021220454.png]]
- **–ò–Ω—Ç—É–∏—Ü–∏—è: —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∞—è —Ä–µ—á—å - —Å–ª–æ–∂–Ω–∞—è –≤–µ—â—å. –í —Ä–µ–∞–ª—å–Ω—ã—Ö –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–ª–æ–≤ –∫–∞–∫-—Ç–æ —Å–≤—è–∑–∞–Ω—ã –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º**
	- –ù–∞–ø—Ä–∏–º–µ—Ä : The animal didn't cross the street, because it was tired. –°–ª–æ–≤–æ "it" –æ—á–µ–≤–∏–¥–Ω–æ —Å–≤—è–∑–∞–Ω–æ —Å–æ —Å–ª–æ–≤–æ–º "animal" 
	- –¢–æ–≥–¥–∞ –¥–∞–≤–∞–π—Ç–µ –æ–±—É—á–∏–º **–º–∞—Ç—Ä–∏—Ü—É –≤–µ—Å–æ–≤ –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ —Å –∫–∞–∂–¥—ã–º –¥—Ä—É–≥–∏–º.** –ú–µ—Ä–∞ —Å–≤—è–∑–∏ -  0 –±—É–¥–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–≤—è–∑–∏, 0.99 –±—É–¥–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å –æ–≥—Ä–æ–º–Ω—É—é —Å–≤—è–∑—å 
-  ![[Pasted image 20251021221349.png]]
- –ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤—ã—à–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ —É—Ä–æ–≤–Ω–µ –∏–Ω—Ç—É–∏—Ü–∏–∏: –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ –º—ã —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ–º —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏, –ø—ã—Ç–∞—è—Å—å –Ω–∞–π—Ç–∏ "—Å–≤—è–∑—å"
- ![[Pasted image 20251021221415.png]]
- –ü—É—Å—Ç—å —É –Ω–∞—Å –µ—Å—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–∑ 2—Ö —Å–ª–æ–≤: **Thinking Machines**
- –ú—ã –ø—Ä–æ–≥–æ–Ω—è–µ–º –µ–≥–æ —á–µ—Ä–µ–∑ **Self-Attention, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω 3–º—è –º–∞—Ç—Ä–∏—Ü–∞–º–∏ (WQ,WK,WV)**
	- –ü–µ—Ä–≤—ã–µ –¥–≤–µ –¥–æ–ª–∂–Ω—ã –ø–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø–æ–¥—Ö–æ–¥–∏—Ç—å –ø–æ–¥ –¥–ª–∏–Ω—É —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Ç–æ–∫–µ–Ω–æ–≤, –ø–æ—Ç–æ–º—É —á—Ç–æ –±—É–¥—É—Ç –ø–µ—Ä–µ–º–Ω–æ–∂–∞—Ç—å—Å—è –º–∞—Ç—Ä–∏—á–Ω–æ
	- –ü—Ä–æ —Ç—Ä–µ—Ç—å—é –ø–æ–∑–∂–µ
- –ü—Ä–∏ —É–º–Ω–æ–∂–µ–Ω–∏–∏ –Ω–∞ –º–∞—Ç—Ä–∏—Ü—É WQ –∏–∑ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Å–ª–æ–≤ –º—ã –ø–æ–ª—É—á–∞–µ–º —ç–º–±–µ–¥–¥–∏–Ω–≥ **"–∑–∞–ø—Ä–æ—Å" (query)**, —á–∏—Å–ª–∞ –≤ –Ω–µ–º –∫–æ–¥–∏—Ä—É—é—Ç –≤–æ–ø—Ä–æ—Å –æ—Ç —Ç–æ–∫–µ–Ω–∞ –∫ –æ—Å—Ç–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è "—á—Ç–æ —è –∏—â—É?"
- ![[Pasted image 20251021233501.png]]
- **–ó–∞—Ç–µ–º –æ–Ω —É–º–Ω–æ–∂–∞–µ—Ç—Å—è —Å–∫–∞–ª—è—Ä–Ω–æ –Ω–∞ –º–∞—Ç—Ä–∏—Ü—É WK**. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∫–∞–∫ –±—ã —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ–º "–Ω–∞—Å–∫–æ–ª—å–∫–æ  –∑–∞–ø—Ä–æ—Å —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –∫ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º—É –∫–ª—é—á—É - —à–∞–±–ª–æ–Ω—É, –∫–æ—Ç–æ—Ä—ã–π —è –∑–Ω–∞—é"
	- –í–∞–∂–Ω–æ! –í–æ –≤—Å–µ–º –º–∞—Ç—Ä–∏—á–Ω–æ–º —É–º–Ω–æ–∂–µ–Ω–∏–∏: –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü –∫–∞–∫ –±—É–¥—Ç–æ –±—ã –∏–∑–≤–ª–µ–∫–∞–µ—Ç "–∑–Ω–∞–Ω–∏—è" –∏—Å–ø–æ–ª—å–∑—É—è "–≤–µ—Å–∞". –ê —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∫–∞–∫ –±—É–¥—Ç–æ –±—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–º–µ—Ä—É —Å—Ö–æ–¥—Å—Ç–≤–∞" –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–∞–º–∏/–º–∞—Ç—Ä–∏—Ü–∞–º–∏ (–Ω–∞–∏–±–æ–ª—å—à–µ–µ —á–∏—Å–ª–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –≤–µ–∫—Ç–æ—Ä–∞ —Å–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã, –Ω–∞–∏–º–µ–Ω—å—à–µ–µ - –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã, 0 - –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã)
	- **–ó–∞—Ç–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∞**-  –¥–µ–ª–∏–º –Ω–∞ –∫–æ—Ä–µ–Ω—å –∏–∑ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞
		- –ü–æ–¥—Ä–æ–±–Ω–µ–µ –∑–¥–µ—Å—å: [[scaled dot product]]
		- –ò–Ω—Ç—É–∏—Ü–∏—è: –ü—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –±–µ–∑ –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∏ –º—ã –±—É–¥–µ–º –ø–æ–ª—É—á–∞—Ç—å –æ–≥—Ä–æ–º–Ω—ã–µ —Ä–∞–∑–º–∞—Ö–∏ –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—è—Ö, –ø—Ä–∏ —ç—Ç–æ–º softmax –±—É–¥–µ—Ç –≤—ã—Ä–æ–∂–¥–∞—Ç—å—Å—è –≤ one-hot –≤–µ–∫—Ç–æ—Ä [0,0,0,....,1], –∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –∑–∞—Ç—É—Ö–∞—Ç—å, –æ–±—É—á–µ–Ω–∏–µ –Ω–µ –∏–¥—Ç–∏
	 - **–ó–∞—Ç–µ–º –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞–µ–º softmax,** —Ç–æ–≥–¥–∞ "–º–µ—Ä—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è" –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ —Å –∫–∞–∂–¥—ã–º –≤ —Å—É–º–º–µ –¥–∞–¥—É—Ç 1 (–∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ —É–¥–æ–±–Ω–æ)
- ![[Pasted image 20251021234820.png]]
- **–û–±—Ä–∞—Ç–∏–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π softmax - –æ–ø–µ—Ä–∞—Ü–∏—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è –∫ –¥–ª–∏–Ω–µ –≤—Ö–æ–¥–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏!**
	- –ï—Å–ª–∏ –≤—Ö–æ–¥–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ 2  —Ä–∞–∑–∞ –±–æ–ª—å—à–µ —Ç–æ–∫–µ–Ω–æ–≤ - –¥–µ–ª–∞–µ–º –≤ 4 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
	- ![[Pasted image 20251021235254.png]]
	- –° —ç—Ç–∏–º –º–æ–∂–Ω–æ –±–æ—Ä–æ—Ç—å—Å—è - –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—á–∏—Ç–∞—Ç—å —Å–≤—è–∑—å —Ç–æ–ª—å–∫–æ —Å–æ—Å–µ–¥–Ω–∏—Ö —Å–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä 15 —Å–ª–æ–≤ —Å–ª–µ–≤–∞ –∏ —Å–ø—Ä–∞–≤–∞ –æ—Ç –∫–∞–∂–¥–æ–≥–æ). –≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è sliding window
		- –ö—Å—Ç–∞—Ç–∏, –ø–æ—Å–∫–æ–ª—å–∫—É —É –Ω–∞—Å –º–Ω–æ–≥–æ —Å–ª–æ–µ–≤ —ç–Ω–∫–æ–¥–µ—Ä–∞ --> –º–Ω–æ–≥–æ —Å–ª–æ–µ–≤ self-attention - –≤—Å–µ-—Ç–∞–∫–∏ –¥–∞–∂–µ –¥–∞–ª—å–Ω–∏–µ —Å–ª–æ–≤–∞ –∫–∞–∫–∏–º-—Ç–æ –æ–±—Ä–∞–∑–æ–º –ø–æ–≤–ª–∏—è—é—Ç –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞ –Ω–∞ –≤–µ—Ä—Ö–Ω–∏—Ö —Å–ª–æ—è—Ö
- **–ó–∞—Ç–µ–º** –∑–Ω–∞—á–µ–Ω–∏—è softmax —É–º–Ω–æ–∂–∞—é—Ç—Å—è –Ω–∞ –≤–µ–∫—Ç–æ—Ä "values"
	- –í–µ–∫—Ç–æ—Ä values –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏, –∫—Å—Ç–∞—Ç–∏, –ø–æ—ç—Ç–æ–º—É –º–∞—Ç—Ä–∏—Ü–∞ WV –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –ª—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤
	- –ú–∞—Ç—Ä–∏—Ü–∞ –∫–∞–∫ –±—É–¥—Ç–æ –±—ã –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å: "–ï—Å–ª–∏ —Ç—ã –æ–±—Ä–∞—Ç–∏–ª –Ω–∞ –º–µ–Ω—è –≤–Ω–∏–º–∞–Ω–∏–µ (—Ç–≤–æ–π query –ø–æ—Ö–æ–∂ –Ω–∞ –º–æ–π key)", —Ç–æ –∫–∞–∫–æ–π —Å–º—ã—Å–ª (value) —è —Ö–æ—á—É –¥–æ —Ç–µ–±—è –¥–æ–Ω–µ—Å—Ç–∏? –ß—Ç–æ —è –æ–∑–Ω–∞—á–∞—é?
	- –ü—Ä–∏–º–µ—Ä: –Ø —Å–∫–∞–∑–∞–ª —Å–ª–æ–≤–æ "—Ä–∞–º–∞". –û–Ω–æ –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å –¥–≤–µ—Ä–Ω—É—é —Ä–∞–º—É, –∏–ª–∏ —Ä–∞–º—É —É –∫–∞—Ä—Ç–∏–Ω—ã, –∏–ª–∏ —Ä–∞–º—É –∞–≤—Ç–æ–º–æ–±–∏–ª—è. –í—Å–µ —ç—Ç–∏ —Å–º—ã—Å–ª—ã —è –º–æ–≥—É –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –≤ values 
	- **–í–æ–ø—Ä–æ—Å:** –ó–∞—á–µ–º –Ω—É–∂–µ–Ω –≤–µ–∫—Ç–æ—Ä `Value` (–ø–æ–ª—É—á–µ–Ω–Ω—ã–π —É–º–Ω–æ–∂–µ–Ω–∏–µ–º –Ω–∞ –º–∞—Ç—Ä–∏—Ü—É `W_V`), –µ—Å–ª–∏ —É —Å–ª–æ–≤–∞ —É–∂–µ –µ—Å—Ç—å –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥?
	- **–û—Ç–≤–µ—Ç:** –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è **—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ä–æ–ª–µ–π**.
		- **`Query` –∏ `Key`** –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è **"—Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è"**. –û–Ω–∏ –≤—ã—á–∏—Å–ª—è—é—Ç –≤–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è ‚Äî —Ç–æ –µ—Å—Ç—å, *–Ω–∞—Å–∫–æ–ª—å–∫–æ* –æ–¥–Ω–æ —Å–ª–æ–≤–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ –¥—Ä—É–≥–æ–º—É.
		- **`Value`** ‚Äî —ç—Ç–æ **"–ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞"**. –≠—Ç–æ —Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —Ç–æ—Ç —Å–º—ã—Å–ª, –∫–æ—Ç–æ—Ä—ã–π —Å–ª–æ–≤–æ –ø–µ—Ä–µ–¥–∞—Å—Ç –¥—Ä—É–≥–∏–º, *–ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫* –≤–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è —É–∂–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã.
	- –ú–∞—Ç—Ä–∏—Ü–∞ `W_V` –¥–∞–µ—Ç –º–æ–¥–µ–ª–∏ –≥–∏–±–∫–æ—Å—Ç—å: –æ–Ω–∞ —É—á–∏—Ç—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π "–æ–±—â–∏–π" —ç–º–±–µ–¥–¥–∏–Ω–≥ —Å–ª–æ–≤–∞ –≤ —Ç–∞–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è *–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è* –¥—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ –≤ –¥–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ. –ú–æ–¥–µ–ª—å –º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å, —á—Ç–æ –¥–ª—è "—Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è" –≤–∞–∂–Ω—ã –æ–¥–Ω–∏ –∞—Å–ø–µ–∫—Ç—ã —ç–º–±–µ–¥–¥–∏–Ω–≥–∞, –∞ –¥–ª—è "–ø–µ—Ä–µ–¥–∞—á–∏ —Å–º—ã—Å–ª–∞" ‚Äî –¥—Ä—É–≥–∏–µ.
	 
###### –î–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ Multi-head Self-Attention
![[Pasted image 20251025153852.png]]
- –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è - –≤–≤–µ–¥–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç—Ä–æ–µ–∫ –º–∞—Ç—Ä–∏—Ü (head, –≥–æ–ª–æ–≤) WQ, WK, WV, —Ç–æ–≥–¥–∞ –∫–∞–∂–¥–∞—è —Ç—Ä–æ–π–∫–∞ –±—É–¥–µ—Ç –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –æ–±—Ä–∞—â–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- **–í–∞–∂–Ω–æ!** –¢—Ä–æ–π–∫–∏ –º–∞—Ç—Ä–∏—Ü –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –ø–æ-—Ä–∞–∑–Ω–æ–º—É, —á—Ç–æ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –æ–±—É—á–µ–Ω–∏—è –∫ —Ä–∞–∑–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏—è–º
###### –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Self-Attention:
- "–°–∫–ª–µ–∏–º" —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –≤—Ö–æ–¥–Ω—ã—Ö —Å–ª–æ–≤ –≤ –µ–¥–∏–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É **X**![[Pasted image 20251025154534.png]]
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –ø—Ä–∏ –ø–æ–º–æ—â–∏ —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü —Å—Ä–∞–∑—É –ø–æ–ª—É—á–∞—Ç—å –≤—ã—Ö–æ–¥–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ **Z** –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ–≤ —Å—Ä–∞–∑—É
- –¢–µ–ø–µ—Ä—å, –µ—Å–ª–∏ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Multi-Head, —Ç–æ –ø–æ–ª—É—á–∏–º <\N> —Ç–∞–∫–∏—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ **Z** (–ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≥–æ–ª–æ–≤)![[Pasted image 20251025154330.png]]
- –¢–µ–ø–µ—Ä—å –º—ã –≤—Å–ø–æ–º–∏–Ω–∞–µ–º –æ —Ç–æ–º, —á—Ç–æ **—ç–Ω–∫–æ–¥–µ—Ä –≤—Å–µ–≥–¥–∞ –≤—ã–¥–∞–µ—Ç –Ω–∞ –≤—ã—Ö–æ–¥–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Ç–æ–π –∂–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏, —á—Ç–æ –∏ –Ω–∞ –≤—Ö–æ–¥–µ**
	- –ß—Ç–æ–±—ã –¥–æ–±–∏—Ç—å—Å—è —ç—Ç–æ–≥–æ –ø–æ—Å–ª–µ —Å–ª–æ—è Multi-Head Self-Attention - –º—ã –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É–µ–º –≤—Å–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ **Z1...ZN** –æ–±—É—á–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π Wo, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏ –º–∞—Ç—Ä–∏—á–Ω–æ–º —É–º–Ω–æ–∂–µ–Ω–∏–∏ –≤—ã–ø–ª—é–Ω–µ—Ç –º–∞—Ç—Ä–∏—Ü—É –Ω—É–∂–Ω–æ–π –Ω–∞–º —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏
###### –ò—Ç–æ–≥–æ –ø—Ä–æ Self-Attention (–≤—Å–µ —à–∞–≥–∏):
![[Pasted image 20251025155007.png]]
##### –ü—Ä–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ:
![[Pasted image 20251025155424.png]]
	- **–ü—Ä–æ–±–ª–µ–º–∞:** Self-Attention –≤—ã—á–∏—Å–ª—è–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ–≤, –Ω–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–∏–∫–∞–∫ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å! –¢–æ–ª—å–∫–æ –∏—Ö "–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ"
		- **–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** —É –Ω–∞—Å –µ—Å—Ç—å –∏—Å—Ö–æ–¥–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –¥–ª—è –≤—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ **(X)**. –î–∞–≤–∞–π—Ç–µ –ø–æ–º–∏–º–æ –Ω–µ—ë –æ–±—É—á–∏–º –µ—â–µ –∏ –º–∞—Ç—Ä–∏—Ü—É **T** - –º–∞—Ç—Ä–∏—Ü—É "–ø–æ–∑–∏—Ü–∏–π". –ù–∞ –≤—Ö–æ–¥–µ –º–æ–¥–µ–ª–∏ –±—É–¥–µ–º —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—ã X –∏ T, **–ø–æ–ª—É—á–∏–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Å–ª–æ–≤ —Å —É—á–µ—Ç–æ–º –∏—Ö –ø–æ–ª–æ–∂–µ–Ω–∏—è –≤ —Ç–µ–∫—Å—Ç–µ**
			- **–ü—Ä–æ–±–ª–µ–º–∞ 1:** —Ä–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã T - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –º—ã –Ω–µ —Å–º–æ–∂–µ–º –ø—Ä–∏–¥—É–º–∞—Ç—å –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥ –¥–ª—è —Ç–æ–∫–µ–Ω–∞ –Ω–æ–º–µ—Ä 100500 –º–∏–ª–ª–∏–æ–Ω–æ–≤, —É –Ω–∞—Å –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –¥–ª–∏–Ω—É
			- **–ü—Ä–æ–±–ª–µ–º–∞ 2:** –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å —Ç–µ–∫—Å—Ç–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ - –∫–æ—Ä–æ—Ç–∫–∏–µ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è. –û—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ –æ–±—É—á–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—É T, –µ—Å–ª–∏ —Å–¥–µ–ª–∞—Ç—å –µ—ë —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π
			- **–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞ –Ω–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ —Å—Ç–∞—Ç—å—è—Ö, –Ω–æ –æ—Å–Ω–æ–≤–Ω–∞—è –º—ã—Å–ª—å - –Ω–∞–º –Ω–µ –≤–∞–∂–Ω–æ, —Å—Ç–æ–∏—Ç —Ç–æ–∫–µ–Ω 506 –∏–ª–∏ 510–º –æ—Ç –Ω–∞—Å, –≤–∞–∂–Ω–æ, —á—Ç–æ –æ–Ω –¥–∞–ª–µ–∫ –æ—Ç —Ç–æ–∫–µ–Ω–∞ 1. –¢–æ–≥–¥–∞ –º—ã –º–æ–∂–µ–º —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ–ø—É—Å—Ç–∏—Ç—å

##### –ü—Ä–æ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —Ç—Ä—é–∫–∏ –≤–Ω—É—Ç—Ä–∏ Encoder:
![[Pasted image 20251025160543.png]]

###### Residuals 
–¢—Ä—é–∫ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ "–ø—Ä–æ–∫–∏–¥—ã–≤–∞–Ω–∏–∏" –≤—Ö–æ–¥–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ —ç–Ω–∫–æ–¥–µ—Ä–∞ –≤–Ω—É—Ç—Ä—å —Å–∞–º–æ–≥–æ —ç–Ω–∫–æ–¥–µ—Ä–∞ –ø–æ—Å–ª–µ Self-Attention —Å–ª–æ—è

**–≠—Ç–æ —á–∞—Å—Ç–∏—á–Ω–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –∑–∞—Ç—É—Ö–∞—é—â–∏—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤** - –º—ã –∫–∞–∫ –±—ã –¥–≤–∞–∂–¥—ã —Å—á–∏—Ç–∞–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é –≤—Ö–æ–¥–Ω—ã–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º, —É–≤–µ–ª–∏—á–∏–≤–∞—è –∑–Ω–∞—á–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –∏ —É—Å–∫–æ—Ä—è—è –æ–±—É—á–µ–Ω–∏–µ

![[Pasted image 20251025165515.png]]
###### Layer-Norm

**–í–∞–∂–Ω–æ–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ!** –ù–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ –≤—ã—à–µ - Layer Norm –∏–∑–æ–±—Ä–∞–∂–µ–Ω –ø–æ—Å–ª–µ Self-Attention
–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –ª–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏, —á—Ç–æ –ª—É—á—à–µ —Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –ø–µ—Ä–µ–¥ —Å–ª–æ—è–º–∏ SA/FFN, –∫–∞–∫ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ –Ω–∏–∂–µ:
![[Pasted image 20251025162308.png]]
![[Pasted image 20251025165544.png]]
- –°—É—Ç—å - –º—ã –±–µ—Ä–µ–º —Å–ª–æ–π —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏ —Å—á–∏—Ç–∞–µ–º –ø–æ –Ω–∏–º **Z-score** (–≤—ã—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∏ –¥–µ–ª–∏–º –Ω–∞ std --> –ø–æ–ª—É—á–∞–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º = 1 –∏ std = 1)
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç—Ä—é–∫: –º—ã –≤–≤–æ–¥–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã **–º–Ω–æ–∂–∏—Ç–µ–ª—å a –∏ –∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç b**. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—É –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à–µ Z-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω —Å–æ—á—Ç–µ—Ç –Ω—É–∂–Ω—ã–º
	- **–ü—Ä–∏–º–µ—Ä:** –µ—Å–ª–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä –∑–∞—Ö–æ—á–µ—Ç —Å–¥–µ–ª–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ —Å—Ä–µ–¥–Ω–∏–º = 10 - –æ–Ω –ø–æ—Å—Ç–∞–≤–∏—Ç **b = 10**
	-  **–ü—Ä–∏–º–µ—Ä:** –µ—Å–ª–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä –∑–∞—Ö–æ—á–µ—Ç —Å–¥–µ–ª–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ–º = 10 - –æ–Ω –ø–æ—Å—Ç–∞–≤–∏—Ç **a = 10**
- P.S. –ù–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è—Ö —á–∞—Å—Ç–æ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç –æ "+"/"-" –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è [[LayerNorm vs BatchNorm]]. –í —ç—Ç–æ–π –ª–µ–∫—Ü–∏–∏ –æ–± —ç—Ç–æ–º –±—ã–ª–æ —É–ø–æ–º—è–Ω—É—Ç–æ –ª–∏—à—å –≤—Å–∫–æ–ª—å–∑—å (BatchNorm —Ö—É–∂–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è)

#### –î–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ –¥–µ–∫–æ–¥–µ—Ä 
![[Pasted image 20251025170817.png]]
- **–ó–∞–¥–∞—á–∞ –¥–µ–∫–æ–¥–µ—Ä–∞:** –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ —Å–ª–æ–≤–æ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ –æ–Ω —Å—Ç—Ä–æ–∏—Ç—å –ø–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º –∏–∑ —ç–Ω–∫–æ–¥–µ—Ä–∞
- **–°—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ –ø–æ—Ö–æ–∂ –Ω–∞ —ç–Ω–∫–æ–¥–µ—Ä, –Ω–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è Encoder-Decoder (Cross) Attention:**
- ![[Pasted image 20251025171928.png]]
	- –¢–∞–∫–∂–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä–µ—Ö –º–∞—Ç—Ä–∏—Ü **(Wq,Wk,Wv)**
	- **–ü–µ—Ä–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ Wq –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Ö–æ–¥—É —Å–∞–º–æ–º—É –¥–µ–∫–æ–¥–µ—Ä–∞**
		- **Query (Q)¬†–º–∞—Ç—Ä–∏—Ü–∞** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ –≤—ã—Ö–æ–¥–∞¬†–ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–ª–æ—è¬†–¥–µ–∫–æ–¥–µ—Ä–∞. –≠—Ç–æ –∫–∞–∫ –±—ã "–∑–∞–ø—Ä–æ—Å" –æ—Ç –¥–µ–∫–æ–¥–µ—Ä–∞: "–Ø —Å–µ–π—á–∞—Å –≥–µ–Ω–µ—Ä–∏—Ä—É—é —Å–ª–æ–≤–æ, –≤–æ—Ç –∫–∞–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –º–Ω–µ –Ω—É–∂–Ω–∞ –æ—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è".
			- –ù–∞ —Å–∞–º–æ–º –Ω–∏–∂–Ω–µ–º —Å–ª–æ–µ –≤—Ö–æ–¥ –¥–µ–∫–æ–¥–µ—Ä–∞ - —Å–ª—É–∂–µ–±–Ω—ã–π —Ç–æ–∫–µ–Ω <\start_of_sequence> + –≤—Ö–æ–¥—è—â–∏–π –∑–∞–ø—Ä–æ—Å (–ø—Ä–æ–º–ø—Ç)
	- **–ú–∞—Ç—Ä–∏—Ü—ã Wk, Wv –±–µ—Ä—É—Ç—Å—è –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–ª–æ—è —ç–Ω–∫–æ–¥–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å –≤–æ –≤—Å–µ –±–ª–æ–∫–∏ –¥–µ–∫–æ–¥–µ—Ä–∞**.  –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–∞–∂–¥—ã–π –±–ª–æ–∫ –¥–µ–∫–æ–¥–µ—Ä–∞ –∑–∞–Ω–æ–≤–æ "—Å–º–æ—Ç—Ä–∏—Ç" –Ω–∞¬†–ø–æ–ª–Ω—ã–π –≤—ã–≤–æ–¥ —ç–Ω–∫–æ–¥–µ—Ä–∞ –∏ —Ä–µ—à–∞–µ—Ç, –Ω–∞ –∫–∞–∫–∏–µ —á–∞—Å—Ç–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ–±—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ¬†—Å–ª–æ–≤–æ.
- **–û–±—Ä–∞—Ç–∏–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –¥–µ–∫–æ–¥–µ—Ä –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ö–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç: Previous Outputs** - —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —É–∂–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —ç–Ω–∫–æ–¥–µ—Ä–∞![[Pasted image 20251025171952.png]]
- **Masked Self Attention:** –æ–±—Ä–∞—Ç–∏–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –±–ª–æ–∫–∏ –¥–µ–∫–æ–¥–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç—Ä–µ—É–≥–æ–ª—å–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É. –¢–∞–∫–∞—è –º–∞—Å–∫–∞ –Ω–µ –¥–∞–µ—Ç –¥–µ–∫–æ–¥–µ—Ä—É –ø–æ–¥–≥–ª—è–¥—ã–≤–∞—Ç—å –≤ –±—É–¥—É—â–µ–µ (–Ω–∞ —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –µ—â–µ –Ω–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª). –≠—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –¥–µ–∫–æ–¥–µ—Ä –Ω–∞—É—á–∏–ª—Å—è —Å—Ç—Ä–æ–∏—Ç—å —Å–≤—è–∑–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ —Ç–æ, —á—Ç–æ –æ–Ω —É–∂–µ¬†"—Å–∫–∞–∑–∞–ª".![[Pasted image 20251025172923.png]]
- ![[Pasted image 20251025173321.png]]
- **–ù–∞ –≤–µ—Ä—Ö–Ω–µ–º —Å–ª–æ–µ –º—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –¥–µ–æ–∫–¥–µ—Ä –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–ª —Å–ª–µ–¥—É—é—â–µ–µ —Å–ª–æ–≤–æ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏.** –ü–æ—ç—Ç–æ–º—É –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —Å–ª–æ–µ –¥–µ–∫–æ–¥–µ—Ä–∞ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–≥—Ä–æ–º–Ω—ã–π –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥ –æ—á–µ—Ä–µ–¥–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –≤ –≤–µ–∫—Ç–æ—Ä –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ **(logits)** —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ **vocab_size**
	- –≥–¥–µ vocab_size - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –í–°–ï–• –í–û–ó–ú–û–ñ–ù–´–• —Å–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ –º–æ–∂–µ—Ç –≤—ã–¥–∞—Ç—å –¥–µ–∫–æ–¥–µ—Ä. –ò –∫–∞–∂–¥—ã–π —Ä–∞–∑ –º—ã –≤—ã—á–∏—Å–ª—è–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –î–õ–Ø –í–°–ï–• —Å–ª–æ–≤ –∏–∑ —Å–ª–æ–≤–∞—Ä—è
		- –ù–µ—Å–ª–æ–∂–Ω–æ –¥–æ–≥–∞–¥–∞—Ç—å—Å—è, —á—Ç–æ —ç—Ç–∞ –º–∞—Ç—Ä–∏—Ü–∞ –æ–≥—Ä–æ–º–µ–Ω–Ω–∞—è –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –¥–æ–≤–æ–ª—å–Ω–æ –¥–æ–ª–≥–æ. –°—É—â–µ—Å—Ç–≤—É—é—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–µ —Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ–≤, –∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π softmax

### –ó–∞–¥–∞—á–∞ –æ–±—É—á–µ–Ω–∏—è: 

- –ß—Ç–æ–±—ã –æ–±—É—á–∏—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä, –º—ã –¥–µ–ª–∞–µ–º —Å–ª–µ–¥—É—é—â–µ–µ:
	- –ú–∞—Ç—Ä–∏—Ü–∞ —Ñ–∏—á–µ–π - —ç—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤
	  –ú–∞—Ç—Ä–∏—Ü–∞ —Ç–∞—Ä–≥–µ—Ç–æ–≤ - —ç—Ç–æ —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–∫–µ–Ω –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏![[Pasted image 20251025173111.png]]
-  –ù–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ –¥–µ–∫–æ–¥–µ—Ä–∞ –º—ã –ø–æ–ª—É—á–∞–µ–º –≤–µ–∫—Ç–æ—Ä –ø–æ—Å–ª–µ softmax, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ [0, 0.7, 0.2, .... N]. –ü—Ä–∏ —ç—Ç–æ–º –Ω–∞—à —Ç–∞—Ä–≥–µ—Ç - –≤–µ–∫—Ç–æ—Ä —Ç–∏–ø–∞ [0, 1, 0, 0 .... N] (—Ç–æ –µ—Å—Ç—å –º—ã —É—á–∏–º –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å 100% –¥–ª—è —Ç–æ–≥–æ —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä–æ–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–æ–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏)
	- –ú—ã –≤—ã—á–∏—Å–ª—è–µ–º –Ω–µ–≤—è–∑–∫—É, –∏—Å–ø–æ–ª—å–∑—É—è **Cross Entropy Loss function**. –ü–æ –Ω–µ–π –∏ –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã 

### BERT vs GPT
![[Pasted image 20251025175424.png]]
- –ü–æ–ª–Ω—ã–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä (–º–æ–¥–µ–ª—å –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π **Encoder + Decoder.**
- –ó–∞–º–µ—Ç–∏–º, –æ–¥–Ω–∞–∫–æ, —á—Ç–æ —ç—Ç–∏ —á–∞—Å—Ç–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã. –ú—ã –º–æ–∂–µ–º –º–µ–Ω—è—Ç—å —ç–Ω–∫–æ–¥–µ—Ä—ã –Ω–∞ –ª–µ—Ç—É, –æ—Å—Ç–∞–≤–∏–≤ –¥–µ–∫–æ–¥–µ—Ä - —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –æ—Å—É—â–µ—Å—Ç–≤–ª—è—è –ø–µ—Ä–µ–≤–æ–¥ —Å –ª—é–±–æ–≥–æ —è–∑—ã–∫–∞ –Ω–∞ –ª—é–±–æ–π
- **BERT - encoder-only –º–æ–¥–µ–ª—å.** –û–Ω–∞ –Ω–µ —Å–ø–æ—Å–æ–±–Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ç–æ–∫–µ–Ω—ã, –æ–Ω–∞ –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∏—Ç—å –≤–µ–∫—Ç–æ—Ä–∞
	- –í–æ–∑–Ω–∏–∫–∞–µ—Ç –≤–æ–ø—Ä–æ—Å: –ê –∫–∞–∫ —Ç–æ–≥–¥–∞ –æ–±—É—á–∞–ª–∏ –º–æ–¥–µ–ª—å?
- **GPT-2** - **decoder-only –º–æ–¥–µ–ª—å.** –£ –Ω–∏—Ö –Ω–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –±–ª–æ–∫–∞ —ç–Ω–∫–æ–¥–µ—Ä–æ–≤, –æ–Ω–∏ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Masked Self-Attnetion 
	- –í–æ–∑–Ω–∏–∫–∞–µ—Ç –≤–æ–ø—Ä–æ—Å: –∞ –∫–∞–∫ –ø—Ä–æ—Ç–µ–∫–∞–µ—Ç –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –º–æ–¥–µ–ª–∏?
	- –û—Ç–≤–µ—Ç: –≤ –∫–∞—á–µ—Å—Ç–≤–µ "—ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Å–æ —Å–ª–æ—è —ç–Ω–∫–æ–¥–µ—Ä–∞" –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Ç–æ–∫–µ–Ω–æ–≤ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞.
		- –ü—Ä–∏–º–µ—Ä: –¥–∞–µ–º –∑–∞–ø—Ä–æ–º "–ù–∞–ø–∏—à–∏ —Å—Ç–∏—Ö –æ –ª—É–Ω–µ". –≠—Ç–æ—Ç —Ç–µ–∫—Å—Ç —Ç–æ–∫–µ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –∏ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.
		- –ü–µ—Ä–≤—ã–π —à–∞–≥: –≠—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (–≤–µ—Å—å –≤–∞—à –ø—Ä–æ–º–ø—Ç) –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –≤—Å–µ —Å–ª–æ–∏ –¥–µ–∫–æ–¥–µ—Ä–∞. –ó–∞–¥–∞—á–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ —ç—Ç–æ–º —à–∞–≥–µ ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –æ–¥–Ω–æ —Å–ª–µ–¥—É—é—â–µ–µ —Å–ª–æ–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–ª–∂–Ω–æ –∏–¥—Ç–∏ –ø–æ—Å–ª–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–º–ø—Ç–∞.
		- –ê–≤—Ç–æ—Ä–µ–≥—Ä–µ—Å—Å–∏—è: –ú–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–°–∏—è–µ—Ç").
		- –í—Ç–æ—Ä–æ–π —à–∞–≥: –¢–µ–ø–µ—Ä—å —ç—Ç–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–ª–æ–≤–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–æ–Ω–µ—Ü –≤—Ö–æ–¥–∞. –ù–æ–≤–∞—è –≤—Ö–æ–¥–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å ‚Äî —ç—Ç–æ "–ù–∞–ø–∏—à–∏ —Å—Ç–∏—Ö –æ –ª—É–Ω–µ –°–∏—è–µ—Ç". –û–Ω–∞ —Å–Ω–æ–≤–∞ —Ü–µ–ª–∏–∫–æ–º –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å, –∏ —Ç–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ —Å–ª–æ–≤–æ –∏ —Ç.–¥.

#### –ü—Ä–æ –æ–±—É—á–µ–Ω–∏–µ BERT 

![[Pasted image 20251025175903.png]]
- **–ü–µ—Ä–≤—ã–π (–æ—Å–Ω–æ–≤–Ω–æ–π) –≤–∞—Ä–∏–∞–Ω—Ç –æ–±—É—á–µ–Ω–∏—è —ç—Ç–æ –∑–∞–¥–∞—á–∞ MLM** -  15% –≤—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –≤ input –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ –∑–∞–º–µ–Ω—è–µ–º, —É—á–∏–º BERT –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∏—Ö –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
	- 80% –º—ã –∑–∞–º–µ–Ω—è–µ–º –Ω–∞ —Å–ø–µ—Ü. —Ç–æ–∫–µ–Ω [MASK]
		- –ú–æ—Ç–∏–≤–∞—Ü–∏—è: –ï—Å–ª–∏ –±—ã –º—ã –≤—Å–µ–≥–¥–∞ –∑–∞–º–µ–Ω—è–ª–∏ —Å–ª–æ–≤–∞ –Ω–∞ [MASK], –º–æ–¥–µ–ª—å –±—ã –ø—Ä–∏–≤—ã–∫–ª–∞, —á—Ç–æ –Ω–∞ –≤—Ö–æ–¥–µ –µ—Å—Ç—å —ç—Ç–æ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω, –∏ —É—á–∏–ª–∞—Å—å –±—ã —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å –Ω–∏–º. –ù–æ –Ω–∞ —ç—Ç–∞–ø–µ fine-tuning, –∫–æ–≥–¥–∞ –º—ã —Ä–µ—à–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏, –≤ —Ç–µ–∫—Å—Ç–µ –Ω–∏–∫–∞–∫–∏—Ö [MASK] —Ç–æ–∫–µ–Ω–æ–≤ –Ω–µ—Ç. –ú–æ–¥–µ–ª—å –±—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∞—Å—å —Å –¥–∞–Ω–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∞ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–∏–¥–µ–ª–∞, –∏ —Ä–∞–±–æ—Ç–∞–ª–∞ –±—ã —Ö—É–∂–µ
	- –ü—Ä–∏ —ç—Ç–æ–º 10% –∏–∑ —ç—Ç–∏—Ö 15% –º—ã –∑–∞–º–µ–Ω—è–µ–º —Ä–∞–Ω–¥–æ–º–Ω—ã–º —Å–ª–æ–≤–æ–º
		- –¢–µ–ø–µ—Ä—å –º–æ–¥–µ–ª–∏ –Ω—É–∂–Ω–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ "–≤—Å—Ç–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ –≤ –ø—Ä–æ–ø—É—Å–∫", –∞ –ø–æ–Ω—è—Ç—å, —á—Ç–æ —Å—Ç–æ—è—â–µ–µ –Ω–∞ —ç—Ç–æ–º –º–µ—Å—Ç–µ —Å–ª–æ–≤–æ ‚Äî –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ (—á—Ç–æ –±—ã–≤–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –º–∏—Ä–µ), –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≤–µ—Ä–Ω—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥.
	- –ü—Ä–∏ —ç—Ç–æ–º 10% –∏–∑ —ç—Ç–∏—Ö 15% –º—ã –∑–∞–º–µ–Ω—è–µ–º –Ω–∞ —Ç–æ –∂–µ —Å–∞–º–æ–µ —Å–ª–æ–≤–æ 
		- –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã –≥–æ–≤–æ—Ä–∏–º –º–æ–¥–µ–ª–∏: "–í–Ω–∏–º–∞–Ω–∏–µ, –Ω–µ –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–µ —è –ø—Ä–æ—à—É —Ç–µ–±—è –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ, –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–æ–ø—É—â–µ–Ω–æ –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω–æ. –ò–Ω–æ–≥–¥–∞ —Å–ª–æ–≤–æ –Ω–∞ –º–µ—Å—Ç–µ, –∏ —Ç–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ø–æ–Ω—è—Ç—å —ç—Ç–æ –∏ –≤—ã–¥–∞—Ç—å –µ–≥–æ –∂–µ". –≠—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é, –≥–¥–µ –º–æ–¥–µ–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Ö–æ—Ä–æ—à–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö
- –ü–æ–≤–µ—Ä—Ö –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ —Ç–æ–∫–µ–Ω–∞ [MASK] —Å—Ç–∞–≤–∏—Ç—Å—è –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π —Å softmax (–ø—Ä—è–º –∫–∞–∫ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ –≤—ã—à–µ –¥–ª—è –¥–µ–∫–æ–¥–µ—Ä–∞), –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –ª—é–±–æ–≥–æ —Å–ª–æ–≤–∞ –∏–∑ –≤—Å–µ–≥–æ —Å–ª–æ–≤–∞—Ä—è. –î–∞–ª–µ–µ –±–µ—Ä–µ—Ç—Å—è Cross-Entropy Loss
- **–í—Ç–æ—Ä–∞—è (–≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è) –∑–∞–¥–∞—á–∞: NSP** ![[Pasted image 20251025180159.png]]
- **–ó–∞–¥–∞—á–∞ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –Ω–∞—É—á–∏—Ç—å —ç–Ω–∫–æ–¥–µ—Ä –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å, —Å–≤—è–∑–∞–Ω—ã –ª–∏ –¥–≤–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º.** –í –Ω–∞—á–∞–ª–æ –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–º–µ—â–∞—é—Ç —Ç–æ–∫–µ–Ω [CLS]. –ü–æ–≤–µ—Ä—Ö –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ —Ç–æ–∫–µ–Ω–∞ [CLS] —Å—Ç–∞–≤—è—Ç –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π –∫–∞–∫ –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞. –û–Ω –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç 1/0 (—è–≤–ª—è–ª–∞ –ª–∏ –∏—Å—Ö–æ–¥–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –µ–¥–∏–Ω–æ–µ –ª–æ–≥–∏—á–Ω–æ–µ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–µ) 
- –û–±—É—á–µ–Ω–Ω—ã–π —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º BERT –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä. –ò–¥–µ—è –∏–º–µ–Ω–Ω–æ –≤ —Ç–æ–º, —á—Ç–æ BERT —É—á–∏—Ç—Å—è –∑–∞—à–∏–≤–∞—Ç—å –≤ [CLS] —Ç–æ–∫–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Å–º—ã—Å–ª –≤—Å–µ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, —á—Ç–æ –º—ã –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º
- ![[Pasted image 20251025182751.png]]
- –ò—Ç–æ–≥–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Ç–æ–∫–µ–Ω–æ–≤ –≤ BERT —Å–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –∏–∑:
	- –≠–º–±–µ–¥–¥–∏–Ω–≥ —Ç–æ–∫–µ–Ω–∞
	- –°–µ–≥–º–µ–Ω—Ç-—ç–º–±–µ–¥–¥–∏–Ω–≥ 
		- –û—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å: –∫ –∫–∞–∫–æ–º—É —Å–º—ã—Å–ª–æ–≤–æ–º—É —Å–µ–≥–º–µ–Ω—Ç—É (–æ–±—ã—á–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—é) –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —Ç–æ–∫–µ–Ω?
		- –î–ª—è –µ–≥–æ —Ä–∞–±–æ—Ç—ã –≤–Ω—É—Ç—Ä—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –º—ã –ø–æ–º–µ—â–∞–µ–º —Å–ª—É–∂–µ–±–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã [SEP], –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –∫–æ–Ω–µ—Ü –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è/—Å–º—ã—Å–ª–æ–≤–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ 
	- –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥ (–∫–∞–∫–∏–º –ø–æ —Å—á–µ—Ç—É —è–≤–ª—è–µ—Ç—Å—è —Ç–æ–∫–µ–Ω)?
- –î–ª—è –¥–µ–∫–æ–¥–µ—Ä –º–æ–¥–µ–ª–µ–π —Ç–∞–∫–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ä—è–¥ –∑–∞–¥–∞—á –ø–æ–º–∏–º–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç–æ–∫–µ–Ω–∞, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –∞–∫—Ç–∏–≤–Ω–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É—é—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–¥—ã ![[Pasted image 20251025180319.png]]


#üÉè/nlp
### Key Questions:

1. –ü–æ—á–µ–º—É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç RNN, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –¥–ª–∏–Ω–Ω—ã–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏ –∏ –Ω–µ —Å—Ç—Ä–∞–¥–∞—é—Ç –æ—Ç "–ø–æ—Ç–µ—Ä–∏ –ø–∞–º—è—Ç–∏"?
?
- RNN –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ, –ø–µ—Ä–µ–¥–∞–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —á–µ—Ä–µ–∑ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —à–∞–≥–∞ –∫ —à–∞–≥—É. –ù–∞ –¥–ª–∏–Ω–Ω—ã—Ö –¥–∏—Å—Ç–∞–Ω—Ü–∏—è—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ —ç—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ "—Ä–∞–∑–º—ã–≤–∞–µ—Ç—Å—è" –∏ —Ç–µ—Ä—è–µ—Ç—Å—è.
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã –±–ª–∞–≥–æ–¥–∞—Ä—è –º–µ—Ö–∞–Ω–∏–∑–º—É **Self-Attention** –º–æ–≥—É—Ç –Ω–∞–ø—Ä—è–º—É—é —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å –ª—é–±—É—é –ø–∞—Ä—É —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –Ω–∏–º–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

2. –ö–∞–∫—É—é –∫–ª—é—á–µ–≤—É—é –ø—Ä–æ–±–ª–µ–º—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ RNN —Ä–µ—à–∞—é—Ç —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã?
?
- RNN –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ**, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—é –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –≤—Å–µ —Ç–æ–∫–µ–Ω—ã **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ**, —á—Ç–æ –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö GPU –∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ.

3. –ö–∞–∫ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ç–∏–ø–∞ BPE —Å—Ç—Ä–æ—è—Ç —Å–ª–æ–≤–∞—Ä—å (vocabulary) –∏ –∫–∞–∫ –ø–æ–¥–±–∏—Ä–∞–µ—Ç—Å—è –µ–≥–æ —Ä–∞–∑–º–µ—Ä?
?
- **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ:** –ê–ª–≥–æ—Ä–∏—Ç–º –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç —Å–∞–º—É—é —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â—É—é—Å—è –ø–∞—Ä—É —Å–æ—Å–µ–¥–Ω–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤ –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –µ–µ –≤ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω, –¥–æ–±–∞–≤–ª—è—è –µ–≥–æ –≤ —Å–ª–æ–≤–∞—Ä—å, –ø–æ–∫–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.
- **–†–∞–∑–º–µ—Ä —Å–ª–æ–≤–∞—Ä—è:** –≠—Ç–æ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä. –°–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π —Ä–∞–∑–º–µ—Ä —É–¥–ª–∏–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π ‚Äî —Ä–∞–∑–¥—É–≤–∞–µ—Ç –º–æ–¥–µ–ª—å –∏ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è "–º—É—Å–æ—Ä–Ω—ã–µ" —Ç–æ–∫–µ–Ω—ã. –¢–∏–ø–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: 30-60 —Ç—ã—Å. –¥–ª—è –æ–¥–Ω–æ–≥–æ —è–∑—ã–∫–∞. –ß—Ç–æ–±—ã –ø–æ–¥–æ–±—Ä–∞—Ç—å - —Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø–æ–ª—É—á–∏–≤—à–∏–µ—Å—è —Ç–æ–∫–µ–Ω—ã, —Å–ª–µ–¥–∏–º, —á—Ç–æ–±—ã –≤ –Ω–∏—Ö –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–ª–æ —Ü–µ–ª—ã—Ö —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏–π/–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π, —Ä–µ–¥–∫–∏—Ö –∞–±–±—Ä–∏–≤–µ–∞—Ç—É—Ä

4. –ö–∞–∫–æ–π —Å–ª–æ–π —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º—ã–º –ø–µ—Ä–≤—ã–º –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞ –∏ –∫–∞–∫–æ–≤–∞ –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏—è?
?
- **–°–ª–æ–π:** `Embedding Layer`.
- **–§—É–Ω–∫—Ü–∏—è:** –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ ID —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∏—Ö –Ω–∞—á–∞–ª—å–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (—ç–º–±–µ–¥–¥–∏–Ω–≥–∏). –≠—Ç–æ –æ–±—É—á–∞–µ–º–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–æ–º `[vocabulary_size, embedding_dimension]`, –≥–¥–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ ID —Ç–æ–∫–µ–Ω–∞ –ø—Ä–æ—Å—Ç–æ –±–µ—Ä–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞.

4. –ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω —Å–ª–æ–π Feed Forward (FFN) –∏ –≤ —á–µ–º –µ–≥–æ —Å–º—ã—Å–ª? –°–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –≤–µ—Å–æ–≤ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–æ –∑–¥–µ—Å—å?
?
- **–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:** –î–≤–∞ –ª–∏–Ω–µ–π–Ω—ã—Ö —Å–ª–æ—è —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (ReLU/GeLU) –º–µ–∂–¥—É –Ω–∏–º–∏. –ü–µ—Ä–≤—ã–π —Ä–∞—Å—à–∏—Ä—è–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞, –≤—Ç–æ—Ä–æ–π —Å–∂–∏–º–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ.
- **–°–º—ã—Å–ª:** 
	- –í—Ç–æ—Ä–æ–π –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π —Å—á–∏—Ç–∞–µ—Ç—Å—è "—Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º –∑–Ω–∞–Ω–∏–π" (–æ–≥—Ä–æ–º–Ω–∞—è –æ–±—É—á–∞–µ–º–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤) –º–æ–¥–µ–ª–∏. 
	- –ü–µ—Ä–≤—ã–π –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç "–≤–µ–∫—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞" –∫–æ –≤—Ç–æ—Ä–æ–º—É. "–í–µ–∫—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞" –º–∞—Ç—Ä–∏—á–Ω—ã–º —É–º–Ω–æ–∂–µ–Ω–∏–µ–º –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–∑ –≤—Ç–æ—Ä–æ–≥–æ —Å–ª–æ—è —Ä–µ–ª–µ–≤–∞—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- **–†–∞–∑–º–µ—Ä:** –æ—Ç 66-75% –≤—Å–µ—Ö –≤–µ—Å–æ–≤ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –∑–¥–µ—Å—å

6. –ö–∞–∫–æ–≤—ã –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏—è –≥–ª—É–±–∏–Ω—ã —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞ (–¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤)?
?
- **–ü–ª—é—Å—ã:** –ö–∞–∂–¥—ã–π —Å–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫ —Å—Ç—Ä–æ–∏—Ç –≤—Å–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∏ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (–æ—Ç –ø–æ–Ω–∏–º–∞—è —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ —è–∑—ã–∫–∞ –∫ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–º –≤–µ—â–∞–º)
- **–ú–∏–Ω—É—Å—ã:** –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤—Ä–µ–º—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, —Ç–∞–∫ –∫–∞–∫ –±–ª–æ–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∏ –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –æ–±—É—á–µ–Ω–∏–µ–º –æ—á–µ–Ω—å –≥–ª—É–±–æ–∫–∏—Ö —Å–µ—Ç–µ–π

7. –û–ø–∏—à–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å–ª–æ—è Self-Attention. –í —á–µ–º —Ä–æ–ª—å –º–∞—Ç—Ä–∏—Ü Q, K, V? –ö–∞–∫–æ–≤–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã Self-Attention? –ù–∞—Ä–∏—Å—É–π —Å—Ö–µ–º—É –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞.
?
- **–†–æ–ª—å –º–∞—Ç—Ä–∏—Ü:**
 	- **Query (Q):** "–ó–∞–ø—Ä–æ—Å". –ß—Ç–æ —è (—ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω) –∏—â—É?
 	- **Key (K):** "–ö–ª—é—á". –ú–æ–π "–æ–ø–æ–∑–Ω–∞–≤–∞—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫" –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è.
 	- **Value (V):** "–ó–Ω–∞—á–µ–Ω–∏–µ". –ú–æ—è "–ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞", –∫–æ—Ç–æ—Ä—É—é —è –ø–µ—Ä–µ–¥–∞–º, –µ—Å–ª–∏ –Ω–∞ –º–µ–Ω—è –æ–±—Ä–∞—Ç—è—Ç –≤–Ω–∏–º–∞–Ω–∏–µ.
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥–ª–∏–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ‚Äî O(n¬≤).
- **–°—Ö–µ–º–∞:** ![[Pasted image 20251021233501.png]]

8. –ì–¥–µ –≤–Ω—É—Ç—Ä–∏ Self-Attention —Å–ª–æ—è –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∞ –∏ –∑–∞—á–µ–º –æ–Ω–∞ –Ω—É–∂–Ω–∞? –ü—Ä–∏–≤–µ–¥–∏ —Ñ–æ—Ä–º—É–ª—É.
?
- **–ì–¥–µ:** –ù–æ—Ä–º–∏—Ä–æ–≤–∫–∞ (–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ $\sqrt{d_k}$) –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ –º–∞—Ç—Ä–∏—á–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è $Q$ –Ω–∞ $K^T$, –Ω–æ **–¥–æ** –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ Softmax.
- **–§–æ—Ä–º—É–ª–∞:** $$ \text{Attention}(Q, K, V) = \text{softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right)V $$
- **–ó–∞—á–µ–º:** –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç **–∑–∞—Ç—É—Ö–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ Softmax**. –ü—Ä–∏ –±–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤–µ–∫—Ç–æ—Ä–æ–≤ $d_k$ –¥–∏—Å–ø–µ—Ä—Å–∏—è —Å–∫–∞–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π $QK^T$ —Ä–∞—Å—Ç–µ—Ç. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º –∑–Ω–∞—á–µ–Ω–∏—è–º, –∫–æ—Ç–æ—Ä—ã–µ "–Ω–∞—Å—ã—â–∞—é—Ç" Softmax, –ø—Ä–µ–≤—Ä–∞—â–∞—è –µ–≥–æ –≤—ã—Ö–æ–¥ –≤ one-hot –≤–µ–∫—Ç–æ—Ä, –≥–¥–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–≤–Ω—ã –Ω—É–ª—é, —á—Ç–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ.

9. –í —á–µ–º –∏–¥–µ—è Multi-Head Attention –∏ –∫–∞–∫ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã "–≥–æ–ª–æ–≤"? –ù–∞—Ä–∏—Å—É–π —Å—Ö–µ–º—É.
?
- **–ò–¥–µ—è:** –í —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ Self-Attention —Å–ª–æ—è —Å–æ–∑–¥–∞—é—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ "—Ç—Ä–æ–µ–∫" (–≥–æ–ª–æ–≤) –º–∞—Ç—Ä–∏—Ü Wq, Wk, Wv, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —Ä–∞–∑–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–≤–ª–µ—á—å –∏–∑ –≤—Ö–æ–¥–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–æ–ª—å—à–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ (–±–æ–ª—å—à–µ —Ä–∞–∑–Ω—ã—Ö –∞—Å–ø–µ–∫—Ç–æ–≤). –í –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –Ω–æ—É—Ç–±—É–∫–µ –≥—É–≥–ª–∞ –µ—Å—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (–Ω–∞ —á—Ç–æ –æ–±—Ä–∞—â–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ –∫–∞–∂–¥–∞—è –∏–∑ –≥–æ–ª–æ–≤)
- **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –í—ã—Ö–æ–¥–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –æ—Ç –≤—Å–µ—Ö –≥–æ–ª–æ–≤ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É—é—Ç—Å—è, –∞ –∑–∞—Ç–µ–º –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π (Wo), –∫–æ—Ç–æ—Ä—ã–π —Å–∂–∏–º–∞–µ—Ç –∏—Ö –æ–±—Ä–∞—Ç–Ω–æ –¥–æ –∏—Å—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏.
- **–°—Ö–µ–º–∞:** ![[Pasted image 20251025155007.png]]

10. –ö–∞–∫—É—é –ø—Ä–æ–±–ª–µ–º—É —Ä–µ—à–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∫–∞–∫?
?
- **–ü—Ä–æ–±–ª–µ–º–∞:** Self-Attention –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–µ–Ω –∫ –ø–æ—Ä—è–¥–∫—É —Ç–æ–∫–µ–Ω–æ–≤.
- **–†–µ—à–µ–Ω–∏–µ:** –ö –Ω–∞—á–∞–ª—å–Ω—ã–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ –ø—Ä–∏–±–∞–≤–ª—è–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –≤–µ–∫—Ç–æ—Ä ("–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥"), –∫–æ—Ç–æ—Ä—ã–π "–∑–∞—à–∏–≤–∞–µ—Ç" –≤ –º–æ–¥–µ–ª—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–∞.

11. –ö–∞–∫–∏–µ –¥–≤–µ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ –æ–±—É—á–µ–Ω–∏—è? –ù–∞—Ä–∏—Å—É–π –ø–æ–ª–Ω—É—é —Å—Ö–µ–º—É –±–ª–æ–∫–∞ —ç–Ω–∫–æ–¥–µ—Ä–∞.
?
- **1. Residual Connections:** –í—Ö–æ–¥ –≤ –ø–æ–¥-—Å–ª–æ–π —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è —Å –µ–≥–æ –≤—ã—Ö–æ–¥–æ–º (`X + Sublayer(X)`). –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –±–æ—Ä–æ—Ç—å—Å—è —Å –∑–∞—Ç—É—Ö–∞—é—â–∏–º–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏.
- **2. Layer Normalization:** –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É—è –æ–±—É—á–µ–Ω–∏–µ. –í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞—Ö —Å—Ç–∞–≤–∏—Ç—Å—è **–ø–µ—Ä–µ–¥** –∫–∞–∂–¥—ã–º –ø–æ–¥-—Å–ª–æ–µ–º (Pre-Norm).
- **–°—Ö–µ–º–∞:**  ![[Pasted image 20251025160543.png]]

11. –ß–µ–º Cross-Attention –≤ –¥–µ–∫–æ–¥–µ—Ä–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç Self-Attention? 
?
- –í Self-Attention –≤–µ–∫—Ç–æ—Ä—ã Q, K, V –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∏–∑ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞.
- –í Cross-Attention –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Ä–∞–∑–Ω—ã–µ: **Query (Q)** –±–µ—Ä–µ—Ç—Å—è –∏–∑ –¥–µ–∫–æ–¥–µ—Ä–∞, –∞ **Key (K) –∏ Value (V)** ‚Äî –∏–∑ –≤—ã—Ö–æ–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±–ª–æ–∫–∞ —ç–Ω–∫–æ–¥–µ—Ä–∞. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –¥–µ–∫–æ–¥–µ—Ä "–∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç" –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —É –∏—Å—Ö–æ–¥–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

13. –ó–∞—á–µ–º –≤ –¥–µ–∫–æ–¥–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Masked Self-Attention?
?
- –ß—Ç–æ–±—ã –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ `i` –Ω–µ –º–æ–≥ "–ø–æ–¥–≥–ª—è–¥—ã–≤–∞—Ç—å" –≤ –±—É–¥—É—â–µ–µ –∏ –≤–∏–¥–µ—Ç—å —Ç–æ–∫–µ–Ω—ã –Ω–∞ –ø–æ–∑–∏—Ü–∏—è—Ö `i+1, i+2, ...`. –ú–∞—Å–∫–∞ –∑–∞–Ω—É–ª—è–µ—Ç –≤–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤.

14. –ö–∞–∫–æ–π —Å–ª–æ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ –¥–µ–∫–æ–¥–µ—Ä–∞ –∏ –∫–∞–∫–æ–≤–∞ –µ–≥–æ –∑–∞–¥–∞—á–∞?
?
- –ë–æ–ª—å—à–æ–π **–ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π** –∏ —Ñ—É–Ω–∫—Ü–∏—è **Softmax**.
- **–ó–∞–¥–∞—á–∞:** –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥ —Ç–æ–∫–µ–Ω–∞ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –ø–æ –≤—Å–µ–º—É —Å–ª–æ–≤–∞—Ä—é, —á—Ç–æ–±—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ —Å–ª–æ–≤–æ.

15. –ü–æ—á–µ–º—É BERT –Ω–∞–∑—ã–≤–∞—é—Ç Encoder-only, –∞ GPT ‚Äî Decoder-only?
?
- **BERT** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É **—ç–Ω–∫–æ–¥–µ—Ä–∞** (–¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ) –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —Ç–µ–∫—Å—Ç–∞. –ï–≥–æ –∑–∞–¥–∞—á–∞ ‚Äî **—Å—Ç—Ä–æ–∏—Ç—å –≥–ª—É–±–æ–∫–∏–µ, –Ω–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –≤—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤**.
- **GPT** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É **–¥–µ–∫–æ–¥–µ—Ä–∞** (–æ–¥–Ω–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ, –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ) –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–æ–≤–∞. –ï–≥–æ –∑–∞–¥–∞—á–∞ ‚Äî **–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã**.

16. –í —á–µ–º –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è MLM –∑–∞–¥–∞—á–∞ –æ–±—É—á–µ–Ω–∏—è BERT? 
?
- –í –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º "–ø—Ä—è—á–µ—Ç—Å—è" 15% —Ç–æ–∫–µ–Ω–æ–≤ (–∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ [MASK], —Å–ª—É—á–∞–π–Ω–æ–µ —Å–ª–æ–≤–æ –∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å), –∏ –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å, –∫–∞–∫–∏–µ —Ç–æ–∫–µ–Ω—ã –±—ã–ª–∏ –Ω–∞ –∏—Ö –º–µ—Å—Ç–µ, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ.

17. –ö–∞–∫–æ–≤–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ `[CLS]` –∏ `[SEP]` –≤ BERT?
?
- **`[SEP]` (Separator):** –†–∞–∑–¥–µ–ª—è–µ—Ç –¥–≤–∞ —Å–µ–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–≤–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è), —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–º—ã—Å–ª–æ–≤–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—ã–ª —Ç–æ–∫–µ–Ω
- **`[CLS]` (Classification):** –°—Ç–∞–≤–∏—Ç—Å—è –≤ –Ω–∞—á–∞–ª–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ï–≥–æ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–¥–∞—á –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—Å–µ–≥–æ —Ç–µ–∫—Å—Ç–∞.